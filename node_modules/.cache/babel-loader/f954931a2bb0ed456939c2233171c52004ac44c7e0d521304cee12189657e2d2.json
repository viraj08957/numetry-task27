{"ast":null,"code":"import _objectSpread from\"C:/Users/Viraj/Desktop/task 27/login-register-mern/client/numetry-task27/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Viraj/Desktop/task 27/login-register-mern/client/numetry-task27/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Viraj/Desktop/task 27/login-register-mern/client/numetry-task27/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Viraj/Desktop/task 27/login-register-mern/client/numetry-task27/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import avatar from\"../assets/profile.png\";import{toast,Toaster}from\"react-hot-toast\";import{useFormik}from\"formik\";import{profileValidation}from\"../helper/validate\";import convertToBase64 from\"../helper/convert\";import styles from\"../styles/Username.module.css\";import extend from\"../styles/Profile.module.css\";import{updateUser}from\"../helper/helper\";import{useAuthStore}from\"../store/store\";import useFetch from\"../hooks/fetch.hook\";//===============================\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){var navigate=useNavigate();var _useState=useState(),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useFetch=useFetch(),_useFetch2=_slicedToArray(_useFetch,1),_useFetch2$=_useFetch2[0],isLoading=_useFetch2$.isLoading,apiData=_useFetch2$.apiData,serverError=_useFetch2$.serverError;var formik=useFormik({initialValues:{firstName:(apiData===null||apiData===void 0?void 0:apiData.firstName)||\"\",lastName:(apiData===null||apiData===void 0?void 0:apiData.lastName)||\"\",mobile:(apiData===null||apiData===void 0?void 0:apiData.mobile)||\"\",email:(apiData===null||apiData===void 0?void 0:apiData.email)||\"\",address:(apiData===null||apiData===void 0?void 0:apiData.address)||\"\"},enableReinitialize:true,validate:profileValidation,validateOnBlur:false,validateOnChange:false,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var updateProfilePromise;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:values=Object.assign(values,{profile:file||(apiData===null||apiData===void 0?void 0:apiData.profile)||\"\"});updateProfilePromise=updateUser(values);toast.promise(updateProfilePromise,{loading:\"Updating...\",success:/*#__PURE__*/_jsx(\"b\",{children:\"Updated successfully\"}),error:/*#__PURE__*/_jsx(\"b\",{children:\"Failed to update profile\"})});updateProfilePromise.then(function(res){console.log(res.data.data.msg);});case 4:case\"end\":return _context.stop();}},_callee);}));function onSubmit(_x){return _onSubmit.apply(this,arguments);}return onSubmit;}()});/** formik doesn't support file upload so we need to create this handler */var onUpload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var base64;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return convertToBase64(e.target.files[0]);case 2:base64=_context2.sent;setFile(base64);case 4:case\"end\":return _context2.stop();}},_callee2);}));return function onUpload(_x2){return _ref.apply(this,arguments);};}();var userLogout=function userLogout(e){localStorage.removeItem(\"token\");navigate(\"/\");};if(isLoading)return/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold \",children:\"Loading...\"});if(serverError){console.log(\"server error  : \",serverError);return/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl text-red-500\",children:serverError.message});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-center\",reverseOrder:false}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:styles.glass_register,style:{width:\"45%\",paddingTop:\"3em\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-5xl font-bold\",children:\"Profile\"}),/*#__PURE__*/_jsx(\"span\",{className:\"py-4 text-xl w-2/3 text-center text-gray-500\",children:\"You can update the details\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"py-1\",onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile flex justify-center py-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"profile\",children:/*#__PURE__*/_jsx(\"img\",{src:(apiData===null||apiData===void 0?void 0:apiData.profile)||file||avatar,className:styles.profile_img,alt:\"avatar\"})}),/*#__PURE__*/_jsx(\"input\",{onChange:onUpload,type:\"file\",id:\"profile\",name:\"profile\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"textbox flex flex-col items-center gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps(\"firstName\")),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"First Name\",name:\"firstName\"})),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps(\"lastName\")),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Last Name\",name:\"lastName\"}))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps(\"mobile\")),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Mobile number\",name:\"mobile\"})),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps(\"email\")),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Email\",name:\"email\"}))]}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps(\"address\")),{},{className:styles.textbox,type:\"text\",placeholder:\"Address\",name:\"address\"})),/*#__PURE__*/_jsx(\"button\",{className:styles.btn,type:\"submit\",children:\"Update\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[\"Come back later?\",\" \",/*#__PURE__*/_jsx(Link,{onClick:userLogout,className:\"text-red-500\",to:\"/\",children:\"Logout\"})]})})]})]})})]});}","map":{"version":3,"names":["React","useState","Link","useNavigate","avatar","toast","Toaster","useFormik","profileValidation","convertToBase64","styles","extend","updateUser","useAuthStore","useFetch","Profile","navigate","file","setFile","isLoading","apiData","serverError","formik","initialValues","firstName","lastName","mobile","email","address","enableReinitialize","validate","validateOnBlur","validateOnChange","onSubmit","values","Object","assign","profile","updateProfilePromise","promise","loading","success","error","then","res","console","log","data","msg","onUpload","e","target","files","base64","userLogout","localStorage","removeItem","message","glass_register","width","paddingTop","handleSubmit","profile_img","getFieldProps","textbox","btn"],"sources":["C:/Users/Viraj/Desktop/task 27/login-register-mern/client/numetry-task27/src/component/Profile.js"],"sourcesContent":["import React, { useState } from \"react\"\r\nimport { Link, useNavigate } from \"react-router-dom\"\r\nimport avatar from \"../assets/profile.png\"\r\nimport { toast, Toaster } from \"react-hot-toast\"\r\nimport { useFormik } from \"formik\"\r\nimport { profileValidation } from \"../helper/validate\"\r\nimport convertToBase64 from \"../helper/convert\"\r\n\r\nimport styles from \"../styles/Username.module.css\"\r\nimport extend from \"../styles/Profile.module.css\"\r\nimport { updateUser } from \"../helper/helper\"\r\nimport { useAuthStore } from \"../store/store\"\r\nimport useFetch from \"../hooks/fetch.hook\"\r\n\r\n//===============================\r\nexport default function Profile() {\r\n  const navigate = useNavigate()\r\n  const [file, setFile] = useState()\r\n  const [{ isLoading, apiData, serverError }] = useFetch()\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      firstName: apiData?.firstName || \"\",\r\n      lastName: apiData?.lastName || \"\",\r\n      mobile: apiData?.mobile || \"\",\r\n      email: apiData?.email || \"\",\r\n      address: apiData?.address || \"\",\r\n    },\r\n    enableReinitialize: true,\r\n    validate: profileValidation,\r\n    validateOnBlur: false,\r\n    validateOnChange: false,\r\n    onSubmit: async (values) => {\r\n      values = Object.assign(values, {\r\n        profile: file || apiData?.profile || \"\",\r\n      })\r\n      let updateProfilePromise = updateUser(values)\r\n      toast.promise(updateProfilePromise, {\r\n        loading: \"Updating...\",\r\n        success: <b>Updated successfully</b>,\r\n        error: <b>Failed to update profile</b>,\r\n      })\r\n      updateProfilePromise.then((res) => {\r\n        console.log(res.data.data.msg)\r\n      })\r\n    },\r\n  })\r\n\r\n  /** formik doesn't support file upload so we need to create this handler */\r\n  const onUpload = async (e) => {\r\n    const base64 = await convertToBase64(e.target.files[0])\r\n    setFile(base64)\r\n  }\r\n\r\n  const userLogout = (e) => {\r\n    localStorage.removeItem(\"token\")\r\n    navigate(\"/\")\r\n  }\r\n  if (isLoading) return <h1 className=\"text-2xl font-semibold \">Loading...</h1>\r\n  if (serverError) {\r\n    console.log(\"server error  : \", serverError)\r\n    return <h1 className=\"text-xl text-red-500\">{serverError.message}</h1>\r\n  }\r\n  return (\r\n    <div className=\"container mx-auto\">\r\n      <Toaster position=\"top-center\" reverseOrder={false}></Toaster>\r\n\r\n      <div className=\"flex justify-center items-center h-screen\">\r\n        <div\r\n          className={styles.glass_register}\r\n          style={{ width: \"45%\", paddingTop: \"3em\" }}\r\n        >\r\n          <div className=\"title flex flex-col items-center\">\r\n            <h4 className=\"text-5xl font-bold\">Profile</h4>\r\n            <span className=\"py-4 text-xl w-2/3 text-center text-gray-500\">\r\n              You can update the details\r\n            </span>\r\n          </div>\r\n\r\n          <form className=\"py-1\" onSubmit={formik.handleSubmit}>\r\n            <div className=\"profile flex justify-center py-4\">\r\n              <label htmlFor=\"profile\">\r\n                <img\r\n                  src={apiData?.profile || file || avatar}\r\n                  className={styles.profile_img}\r\n                  alt=\"avatar\"\r\n                />\r\n              </label>\r\n\r\n              <input\r\n                onChange={onUpload}\r\n                type=\"file\"\r\n                id=\"profile\"\r\n                name=\"profile\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"textbox flex flex-col items-center gap-6\">\r\n              <div className=\"name flex w-3/4 gap-10\">\r\n                <input\r\n                  {...formik.getFieldProps(\"firstName\")}\r\n                  className={`${styles.textbox} ${extend.textbox}`}\r\n                  type=\"text\"\r\n                  placeholder=\"First Name\"\r\n                  name=\"firstName\"\r\n                />\r\n                <input\r\n                  {...formik.getFieldProps(\"lastName\")}\r\n                  className={`${styles.textbox} ${extend.textbox}`}\r\n                  type=\"text\"\r\n                  placeholder=\"Last Name\"\r\n                  name=\"lastName\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"name flex w-3/4 gap-10\">\r\n                <input\r\n                  {...formik.getFieldProps(\"mobile\")}\r\n                  className={`${styles.textbox} ${extend.textbox}`}\r\n                  type=\"text\"\r\n                  placeholder=\"Mobile number\"\r\n                  name=\"mobile\"\r\n                />\r\n                <input\r\n                  {...formik.getFieldProps(\"email\")}\r\n                  className={`${styles.textbox} ${extend.textbox}`}\r\n                  type=\"text\"\r\n                  placeholder=\"Email\"\r\n                  name=\"email\"\r\n                />\r\n              </div>\r\n\r\n              <input\r\n                {...formik.getFieldProps(\"address\")}\r\n                className={styles.textbox}\r\n                type=\"text\"\r\n                placeholder=\"Address\"\r\n                name=\"address\"\r\n              />\r\n              <button className={styles.btn} type=\"submit\">\r\n                Update\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"text-center py-4\">\r\n              <span className=\"text-gray-500\">\r\n                Come back later?{\" \"}\r\n                <Link onClick={userLogout} className=\"text-red-500\" to=\"/\">\r\n                  Logout\r\n                </Link>\r\n              </span>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}